#!/bin/bash

cd "${HOME}"

# load the default env
source "${HOME}/.shrc_var"

# use menu as a compose key
setxkbmap -option compose:menu
# make the keyboard more responsive
# arg1= delay (in ms) before the first repetition
# arg2= number of repetitions per second
xset r rate 170 150

# For flash to be fully functionnal
export GDK_NATIVE_WINDOWS=1
export PATH="$(dirname "$0")/bin:$(dirname "$0")/devel_bin:$PATH"

pkill -9 fluxbox

fluxbox &

fbpid=$!

volti &

numlockx
konix_notify_daemon > ~/.notify_daemon_log 2>&1 &
# the real notification daemon
dunst&

# automount usb drives
udisks-glue

sleep 4
{
    fbpager -w &
    killall conky
    wicd-gtk -t &
    conky -d -c "$KONIX_CONKYRC" > ~/conky.log 2> ~/conky.err
	pcmanfm -d --no-desktop & # nice and simple desktop manager
	# start de emacs_tray_daemon if possible
	emacs_tray_daemon.py &
	konix_mail_tray_daemon.py &
    konix_setbg.sh
	konix_seeks.sh
} &

if [ -n "$KONIX_X_INIT" ]
then
	eval "$KONIX_X_INIT"
fi

wait $fbpid
